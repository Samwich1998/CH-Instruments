order = 4;
iterations = 150;

voltammogram = [2.179e-05
 2.176e-05
 2.171e-05
 2.17e-05
 2.171e-05
 2.169e-05
 2.167e-05
 2.166e-05
 2.169e-05
 2.169e-05
 2.168e-05
 2.169e-05
 2.173e-05
 2.174e-05
 2.175e-05
 2.177e-05
 2.183e-05
 2.187e-05
 2.188e-05
 2.194e-05
 2.201e-05
 2.208e-05
 2.212e-05
 2.219e-05
 2.23e-05
 2.239e-05
 2.247e-05
 2.258e-05
 2.274e-05
 2.287e-05
 2.3e-05
 2.316e-05
 2.338e-05
 2.358e-05
 2.377e-05
 2.399e-05
 2.425e-05
 2.449e-05
 2.471e-05
 2.493e-05
 2.518e-05
 2.539e-05
 2.555e-05
 2.574e-05
 2.591e-05
 2.605e-05
 2.614e-05
 2.623e-05
 2.635e-05
 2.644e-05
 2.65e-05
 2.66e-05
 2.672e-05
 2.681e-05
 2.689e-05
 2.7e-05
 2.713e-05
 2.724e-05
 2.731e-05
 2.742e-05
 2.755e-05
 2.764e-05
 2.77e-05
 2.778e-05
 2.79e-05
 2.797e-05
 2.801e-05
 2.815e-05
 2.825e-05
 2.832e-05
 2.836e-05
 2.844e-05
 2.854e-05
 2.862e-05
 2.867e-05
 2.874e-05
 2.886e-05
 2.894e-05
 2.9e-05
 2.904e-05
 2.916e-05
 2.925e-05
 2.93e-05
 2.941e-05
 2.954e-05
 2.964e-05
 2.973e-05
 2.985e-05
 3e-05
 3.014e-05
 3.024e-05
 3.039e-05
 3.056e-05
 3.071e-05
 3.084e-05
 3.1e-05
 3.122e-05
 3.141e-05
 3.157e-05
 3.178e-05
 3.202e-05
 3.225e-05
 3.246e-05
 3.271e-05
 3.3e-05
 3.327e-05
 3.351e-05
 3.381e-05
 3.416e-05
 3.448e-05
 3.478e-05
 3.513e-05
 3.555e-05
 3.594e-05
 3.629e-05
 3.672e-05
 3.72e-05
 3.765e-05
 3.808e-05
 3.857e-05
 3.912e-05
 3.965e-05
 4.013e-05
 4.069e-05
];

x = 1:length(voltammogram);
voltammogram = transpose(voltammogram);

[baseline]=getbaseline(voltammogram,order,iterations);

corrected_voltammogram = voltammogram - baseline;
plot(x,voltammogram,'b-',x,baseline,'r--',x,corrected_voltammogram,'g-.');

legend('Initial voltammogram','Baseline','Corrected voltammogram');